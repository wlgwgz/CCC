<!-- 注意事项 -->
<!-- 起始分级标题：##（二级标题） -->

## 定时防冻

若满足以下任意条件，则无 “**A区定时防冻**”、无 “**B区定时防冻**”、无 “**热水定时防冻**”逻辑：

- 【**防冻功能设置**】设为 “禁用”
- 已进入商检功能
- 已进入试运行功能
- 【**定时防冻间隔**】设为 “0”
- “空调模式”为制冷
- 已进入运行态空调水路防冻
- 已进入运行态热水水路防冻
- A区、B区和热水均未运行

否则，有以下 “**A区定时防冻**”、“**B区定时防冻**”、“**热水定时防冻**”逻辑。

### A区定时防冻

- 不可执行 “**A区定时防冻**” 逻辑，需满足以下任意条件：
  - A区已运行
  - 已进入 “**运行态空调水路防冻**”
  - 【**模块个数**】＞1，且【**热水模块个数**】＜【**模块个数**】，且A区未运行，且B区未运行，且热水运行
  - **环境温度`TA`** 可用，且  **环境温度`TA`** ＞【**进防冻环温**】＋【**退防冻环温差**】
- 否则，允许执行以下 “**A区定时防冻**” 逻辑：

#### A区定时防冻温度

- “**A区定时防冻温度**” ＝ MIN(**缓冲水箱上部温度`TACt1`**, **缓冲水箱下部温度`TACt2`**)
- “**进A区定时防冻温度**”＝【**水泵防冻温度**】
- “**退A区定时防冻温度**” 计算如下：
  - 【**模块个数**】＝1或【**热水模块个数**】≥【**模块个数**】时，“**退A区定时防冻温度**” ＝【**压机退防冻温度**】
  - 【**模块个数**】＞1，且【**热水模块个数**】＜【**模块个数**】时，“**退A区定时防冻温度**” ＝【**水泵防冻温度**】

#### 进入A区定时防冻

- 当 **外循环泵`PUMPo`** 定时防冻停机时间 ≥【**定时防冻间隔**】，且满足以下任意条件时，开启 **外循环泵`PUMPo`**：
  - **环境温度`TA`** 故障
  - **环境温度`TA`** 可用，且 **环境温度`TA`** ≤【**进防冻环温**】
- 进入 “**A区定时防冻**”，需满足以下所有条件：
  - **环境温度`TA`** 故障，或 **环境温度`TA`** ≤【**进防冻环温**】
  - “**A区定时防冻温度**” 故障，或  **外循环泵`PUMPo`** 已持续运行180S且 “**A区定时防冻温度**” 可用且 “**A区定时防冻温度**” ≤ “**进A区定时防冻温度**”

#### 退出A区定时防冻

退出 “**A区定时防冻**”，需满足以下任意条件：

- **环境温度`TA`** 可用，且 **环境温度`TA`** ＞【**进防冻环温**】＋【**退防冻环温差**】
- **外循环泵`PUMPo`** 已持续运行180S，且 “**A区定时防冻温度**” 可用，且 “**A区定时防冻温度**” ＞ “**退A区定时防冻温度**”
- **外循环泵`PUMPo`** 定时防冻运行时间 ＞【**定时防冻时长**】

#### A区定时防冻动作

进入 “**A区定时防冻**” 后，各部件动作描述如下：

- **变频水泵`PUMPf`**：按正常逻辑动作
- **外循环泵`PUMPo`**：打开
- **混合水泵`PUMPm`**：按正常逻辑动作
- **下回水泵`PUMPret`**：按正常逻辑动作
- **太阳能水泵`PUMPsl`**：按正常逻辑动作
- **电磁三通阀1`S3V1`**：
  - A区未运行且B区未运行时， **电磁三通阀1`S3V1`** 保持ON输出
  - A区已运行或B区已运行时， **电磁三通阀1`S3V1`** 按正常逻辑动作
- **电磁三通阀2`S3V2`**：进入A区定时防冻后，先保持OFF输出，再切换为ON输出，切换周期为90秒
- **电磁三通阀3`S3V3`**：按正常逻辑动作
- **变频压机`COMPf`**：
  - 【**模块个数**】＝ 1或【**热水模块个数**】≥【**模块个数**】时， **变频压机`COMPf`** 保持开启
  - 【**模块个数**】＞ 1，且【**热水模块个数**】＜【**模块个数**】时， **变频压机`COMPf`** 按正常逻辑动作

### B区定时防冻

- 不可执行 “**B区定时防冻**” 逻辑，需满足以下任意条件：
  - B区已运行
  - 已进入 “**运行态空调水路防冻**”
  - 非 “**线控器双区水温控制**”，且非 “**线控器双区混合控制**”，且非 “**温控器双区控制**”
  - 【**模块个数**】＞1，且【**热水模块个数**】＜【**模块个数**】，且A区未运行，且B区未运行，且热水运行
- 否则，允许执行以下 “**B区定时防冻**” 逻辑：

#### B区定时防冻温度

- “**B区定时防冻温度**” ＝ MIN(**缓冲水箱上部温度`TACt1`**, **缓冲水箱下部温度`TACt2`**, **地暖进水温度`TFLin`**)
- “**进B区定时防冻温度**” ＝【**水泵防冻温度**】
- “**退B区定时防冻温度**” 计算如下：
  - 【**模块个数**】＝ 1或【**热水模块个数**】≥【**模块个数**】时，“**退B区定时防冻温度**” ＝【**压机退防冻温度**】
  - 【**模块个数**】＞1，且【**热水模块个数**】＜【**模块个数**】时，“**退B区定时防冻温度**” ＝【**水泵防冻温度**】

#### 进入B区定时防冻

- 当 **混合水泵`PUMPm`** 定时防冻停机时间 ≥【**定时防冻间隔**】，且满足以下任意条件时，开启 **混合水泵`PUMPm`**：
  - **环境温度`TA`** 可用，且 **环境温度`TA`** ≤【**进防冻环温**】
  - **环境温度`TA`** 故障
- 进入 “**B区定时防冻**”，需满足以下所有条件：
  - **环境温度`TA`** 故障，或 **环境温度`TA`** ≤【**进防冻环温**】
  - “**B区定时防冻温度**” 故障，或  **混合水泵`PUMPm`** 持续运行180S且 “**B区定时防冻温度**” 可用且 “**B区定时防冻温度**” ≤ “**进B区定时防冻温度**”

#### 退出B区定时防冻

退出 “**B区定时防冻**”，需满足以下任意条件：

- **环境温度`TA`** 可用，且 **环境温度`TA`** ＞【**进防冻环温**】＋【**退防冻环温差**】
- **混合水泵`PUMPm`** 持续运行180S，且 “**B区定时防冻温度**” 可用，且 “**B区定时防冻温度**” ＞ “**退B区定时防冻温度**”
- **混合环泵`PUMPm`** 定时防冻运行时间 ＞【**定时防冻时长**】

#### B区定时防冻动作

进入 “**B区定时防冻**” 后，各部件动作描述如下：

- **变频水泵`PUMPf`**：按正常逻辑动作
- **外循环泵`PUMPo`**：按正常逻辑动作
- **混合水泵`PUMPm`**：打开
- **下回水泵`PUMPret`**：按正常逻辑动作
- **太阳能水泵`PUMPsl`**：按正常逻辑动作
- **电磁三通阀1`S3V1`**：
  - A区未运行且B区未运行时， **电磁三通阀1`S3V1`** 保持ON输出
  - A区已运行或B区已运行时， **电磁三通阀1`S3V1`** 按正常逻辑动作
- **电磁三通阀2`S3V2`**：按正常逻辑动作
- **电磁三通阀3`S3V3`**：保持OFF输出（需将【**地暖进水温度探头**】设为“使用”）
- **变频压机`COMPf`**：
  - 【**模块个数**】＝ 1或【**热水模块个数**】≥【**模块个数**】时，**变频压机`COMPf`** 保持开启
  - 【**模块个数**】＞1，且【**热水模块个数**】＜【**模块个数**】时，**变频压机`COMPf`** 按正常逻辑动作

### 热水定时防冻

- 不可执行 “**热水定时防冻**” 逻辑，需满足以下任意条件：
  - 【**热水功能**】设为 “**禁用**”
  - 热水已运行
  - 已进入 “**运行态热水水路防冻**”
  - 【**模块个数**】＞1，且【**热水模块个数**】＜【**模块个数**】
- 否则，允许执行以下 “**热水定时防冻**” 逻辑：

#### 热水定时防冻温度

- “**热水定时防冻温度**” ＝ **热水水箱温度`THWt`**
- “**进热水定时防冻温度**” ＝【**水泵防冻温度**】
- “**退热水定时防冻温度**” 计算如下：
  - 【**模块个数**】＝ 1或【**热水模块个数**】≥【**模块个数**】时，“**退热水定时防冻温度**” ＝【**压机退防冻温度**】
  - 【**模块个数**】＞1，且【**热水模块个数**】＜【**模块个数**】时，“**退热水定时防冻温度**” ＝【**水泵防冻温度**】

#### 进入热水定时防冻

1. 要令 **电磁三通阀1`S3V1`** 保持OFF输出，需满足以下所有条件：
   - **变频水泵`PUMPf`** 未参与热水定时防冻的时间 ≥【**定时防冻间隔**】
   - **环境温度`TA`** 故障，或 **环境温度`TA`** ≤【**进防冻环温**】
   - “**热水定时防冻温度**” 故障，或 “**热水定时防冻温度**” 可用，且 “**热水定时防冻温度**” < “**退热水定时防冻温度**” + 5℃
2. 进入 “**热水定时防冻**”，需满足以下所有条件：
   - **环境温度`TA`** 故障，或 **环境温度`TA`** ≤【**进防冻环温**】
   - “**热水定时防冻温度**” 故障，或  **变频水泵`PUMPf`** 持续运行180S，且 “**热水定时防冻温度**” 可用，且 “**热水定时防冻温度**” ≤ “**进热水定时防冻温度**”

#### 退出热水定时防冻

退出 “**热水定时防冻**”，需满足以下任意条件：

- **环境温度`TA`** 可用，且 **环境温度`TA`** ＞【**进防冻环温**】＋【**退防冻环温差**】
- **变频水泵`PUMPf`** 持续运行180S，且 “**热水定时防冻温度**” 可用，且 “**热水定时防冻温度**” ＞ “**退热水定时防冻温度**”
- **变频水泵`PUMPf`** 热水定时防冻运行时间 ＞【**定时防冻时长**】

#### 热水定时防冻动作

进入 “**热水定时防冻**” 后，各部件动作描述如下：

- **变频水泵`PUMPf`**：打开
- **外循环泵`PUMPo`**：按正常逻辑动作
- **混合水泵`PUMPm`**：按正常逻辑动作
- **下回水泵`PUMPret`**：打开
- **太阳能水泵`PUMPsl`**：打开（需将【**太阳能**】和【**热水功能**】均设为 “使用”）
- **电磁三通阀1`S3V1`**：保持OFF输出
- **电磁三通阀2`S3V2`**：按正常逻辑动作
- **电磁三通阀3`S3V3`**：按正常逻辑动作
- **变频压机`COMPf`**：
  - 【**模块个数**】＝ 1或【**热水模块个数**】≥【**模块个数**】时，**变频压机`COMPf`** 保持开启
  - 【**模块个数**】＞ 1，且【**热水模块个数**】＜【**模块个数**】时，**变频压机`COMPf`** 按正常逻辑动作

### 定时防冻过程中除霜

若 “**A区定时防冻**” 或 “**B区定时防冻**” 或 “**热水定时防冻**” 过程中，需要开启 **变频压机`COMPf`** 且满足除霜条件时，则优先进行除霜，除霜完成后继续防冻直至退出防冻。
